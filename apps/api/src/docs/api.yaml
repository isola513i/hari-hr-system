paths:
  /api/auth/login:
    post:
      tags:
        - Authentication
      summary: User login
      description: Authenticate user and receive JWT token
      security: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/LoginRequest'
      responses:
        '200':
          description: Successful login
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/LoginResponse'
        '401':
          description: Invalid credentials
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '429':
          description: Too many login attempts

  /api/auth/change-password:
    post:
      tags:
        - Authentication
      summary: Change password
      description: Change the current user's password
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/ChangePasswordRequest'
      responses:
        '200':
          description: Password changed successfully
        '400':
          description: Invalid password or validation error
        '401':
          description: Unauthorized

  /api/employees:
    get:
      tags:
        - Employees
      summary: Get all employees
      description: Retrieve a list of all employees with optional pagination and filtering
      parameters:
        - in: query
          name: page
          schema:
            type: integer
            default: 1
          description: Page number (enables pagination)
        - in: query
          name: limit
          schema:
            type: integer
            default: 20
            maximum: 100
          description: Items per page
        - in: query
          name: department
          schema:
            type: string
          description: Filter by department
        - in: query
          name: status
          schema:
            type: string
            enum: [Active, On Leave, Terminated]
          description: Filter by status
        - in: query
          name: search
          schema:
            type: string
          description: Search by name, email, or role
        - in: query
          name: sortBy
          schema:
            type: string
            enum: [name, email, department, role, status, join_date, created_at]
          description: Field to sort by
        - in: query
          name: sortOrder
          schema:
            type: string
            enum: [ASC, DESC]
          description: Sort direction
      responses:
        '200':
          description: Successful response
          content:
            application/json:
              schema:
                oneOf:
                  - type: array
                    items:
                      $ref: '#/components/schemas/Employee'
                  - $ref: '#/components/schemas/PaginatedResponse'
        '401':
          description: Unauthorized

    post:
      tags:
        - Employees
      summary: Create new employee
      description: Create a new employee (HR_ADMIN only)
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CreateEmployee'
      responses:
        '201':
          description: Employee created successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Employee'
        '400':
          description: Validation error or email already exists
        '401':
          description: Unauthorized
        '403':
          description: Forbidden - requires HR_ADMIN role

  /api/employees/{id}:
    get:
      tags:
        - Employees
      summary: Get employee by ID
      parameters:
        - in: path
          name: id
          required: true
          schema:
            type: string
            format: uuid
      responses:
        '200':
          description: Successful response
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Employee'
        '404':
          description: Employee not found

    put:
      tags:
        - Employees
      summary: Update employee
      description: Update an existing employee (HR_ADMIN only)
      parameters:
        - in: path
          name: id
          required: true
          schema:
            type: string
            format: uuid
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                name:
                  type: string
                email:
                  type: string
                  format: email
                role:
                  type: string
                department:
                  type: string
                salary:
                  type: number
      responses:
        '200':
          description: Employee updated successfully
        '403':
          description: Forbidden - requires HR_ADMIN role
        '404':
          description: Employee not found

    delete:
      tags:
        - Employees
      summary: Delete employee
      description: Delete an employee (HR_ADMIN only)
      parameters:
        - in: path
          name: id
          required: true
          schema:
            type: string
            format: uuid
      responses:
        '200':
          description: Employee deleted successfully
        '403':
          description: Forbidden - requires HR_ADMIN role
        '404':
          description: Employee not found

  /api/leave-requests:
    get:
      tags:
        - Leave Requests
      summary: Get all leave requests
      responses:
        '200':
          description: Successful response
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/LeaveRequest'

    post:
      tags:
        - Leave Requests
      summary: Create leave request
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CreateLeaveRequest'
      responses:
        '201':
          description: Leave request created
        '400':
          description: Validation error

  /api/leave-requests/{id}:
    patch:
      tags:
        - Leave Requests
      summary: Update leave request status
      description: Approve or reject a leave request (HR_ADMIN only)
      parameters:
        - in: path
          name: id
          required: true
          schema:
            type: string
            format: uuid
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                status:
                  type: string
                  enum: [Approved, Rejected]
      responses:
        '200':
          description: Leave request updated
        '403':
          description: Forbidden - requires HR_ADMIN role
        '404':
          description: Leave request not found

    delete:
      tags:
        - Leave Requests
      summary: Delete leave request
      description: Delete a leave request (HR_ADMIN only)
      parameters:
        - in: path
          name: id
          required: true
          schema:
            type: string
            format: uuid
      responses:
        '200':
          description: Leave request deleted
        '403':
          description: Forbidden - requires HR_ADMIN role

  /api/leave-requests/balances/{employeeId}:
    get:
      tags:
        - Leave Requests
      summary: Get leave balances
      description: Get leave balance for an employee
      parameters:
        - in: path
          name: employeeId
          required: true
          schema:
            type: string
            format: uuid
      responses:
        '200':
          description: Successful response
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/LeaveBalance'

  /api/audit-logs:
    get:
      tags:
        - System
      summary: Get audit logs
      description: Retrieve recent audit logs
      responses:
        '200':
          description: Successful response
          content:
            application/json:
              schema:
                type: array
                items:
                  type: object
                  properties:
                    id:
                      type: integer
                    user:
                      type: string
                    action:
                      type: string
                    target:
                      type: string
                    time:
                      type: string
                    type:
                      type: string

  /api/system/seed:
    post:
      tags:
        - System
      summary: Seed database
      description: Manually trigger database seed (HR_ADMIN only)
      responses:
        '200':
          description: Database seeded successfully
        '401':
          description: Unauthorized
        '403':
          description: Forbidden - requires HR_ADMIN role
